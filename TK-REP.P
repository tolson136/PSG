DEF SHARED VAR XPROG AS LOGICAL.
DEF SHARED VAR XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE NEW SHARED VARIABLE BEG# AS INTEGER FORMAT "ZZ"
  LABEL "MONTH".
DEFINE NEW SHARED VARIABLE F-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "CUST #".
DEFINE NEW SHARED VARIABLE F-PROP AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "PROP #".
DEFINE NEW SHARED VARIABLE F-ITEM AS INTEGER FORMAT "ZZZZ"
    LABEL "ITEM #".
DEFINE NEW SHARED VARIABLE F-INDX AS INTEGER FORMAT "ZZ"
    LABEL "TICK INDEX".
DEFINE NEW SHARED VAR F-NUM AS CHAR FORMAT "X(4)".
DEFINE NEW SHARED VAR F-MAN AS INTEGER FORMAT "ZZZ".
DEF NEW SHARED VAR F-DATE AS DATE FORMAT "99/99/9999".
IF (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
REPEAT:
DISPLAY SPACE(13)
"R E P R I N T   T I C K E T   I N P U T   S C R E E N"
    SKIP(0)
XCOM-N LABEL "CO" XDIV-N LABEL "DV" XOPR LABEL "OPER"
SKIP(1) WITH FRAME X NO-BOX SIDE-LABELS.
PROMPT-FOR TICKET.CUST#
	   TICKET.PROPSL#
	   TICKET.ITEM#
	   TICKET.MONTH#
	   TICKET.T-INDX WITH FRAME X NO-BOX SIDE-LABELS.
F-CUST = INPUT TICKET.CUST#.
BEG# = INPUT TICKET.MONTH#.
F-PROP = INPUT TICKET.PROPSL#.
F-ITEM = INPUT TICKET.ITEM#.
F-INDX = INPUT TICKET.T-INDX.
     IF LASTKEY = KEYCODE("F4") THEN LEAVE.
     IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
IF NOT XPROG THEN DO:
FIND FIRST PROPSL WHERE PROPSL.COMP# = XCOM AND
			PROPSL.DIV# = XDIV AND
			PROPSL.CUST# = F-CUST AND
			PROPSL.PROPSL# = F-PROP NO-ERROR.
IF NOT AVAILABLE PROPSL THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THIS PROPOSAL NO LONGER EXISTS".
    BELL.
    UNDO, RETRY.
END.
     IF PROPSL.JANITOR THEN RUN TK-REPJ.P.
     IF NOT PROPSL.JANITOR THEN RUN TK-REPR.P.
END.
ELSE DO:
FIND FIRST METPRO WHERE METPRO.COMP# = XCOM AND
			METPRO.DIV# = XDIV AND
			METPRO.CUST# = F-CUST AND
			METPRO.PROPSL# = F-PROP NO-ERROR.
IF NOT AVAILABLE METPRO THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THIS CONTRACT NO LONGER EXISTS".
    BELL.
    UNDO, RETRY.
END.
     IF METPRO.JANITOR THEN RUN TK-REPJP.P.
     IF NOT METPRO.JANITOR THEN RUN TK-REPRP.P.
END.
END.
